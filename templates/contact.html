{% extends "base.html" %}

{% block title %}Contact | M.G Web Design{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/contact.css') }}">
{% endblock %}

{% block content %}
<section class="contact-section">
    <div class="contact-left">
        <form class="contact-form" id="contactForm">
            <h2>Contact Me</h2>

            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name">
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email">
            </div>

            <div class="form-group">
                <label for="phone">Phone</label>
                <input type="text" id="phone" name="phone">
            </div>

            <div class="form-group">
                <label for="message">Message</label>
                <textarea id="message" name="message" rows="5"></textarea>
            </div>

            <button type="submit" class="btn">Send Message</button>
        </form>

        <!-- Flash messages container -->
        <div class="flash-messages" id="flashContainer"></div>
    </div>

    <div class="contact-right">
        <h2>Let's Build Something Amazing Together!</h2>
        <p>From responsive designs to SEO-friendly websites, I make sure your online presence is strong, modern, and tailored to your brand.</p>
    </div>
</section>

<script>
const form = document.getElementById('contactForm');
const flashContainer = document.getElementById('flashContainer');

form.addEventListener('submit', function(event) {
    event.preventDefault();  // sprječavamo reload

    const formData = new FormData(form);

    fetch("/contact", {
        method: "POST",
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        const div = document.createElement('div');
        div.className = `flash ${data.status}`;
        div.textContent = data.message;
        flashContainer.appendChild(div);

        setTimeout(() => div.remove(), 4000);

        if(data.status === "success") form.reset();
    })
    .catch(err => {
        console.error("Error:", err);
        const div = document.createElement('div');
        div.className = "flash error";
        div.textContent = "An unexpected error occurred.";
        flashContainer.appendChild(div);
        setTimeout(() => div.remove(), 4000);
    });
});
</script>
{% endblock %}
